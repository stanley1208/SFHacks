<!DOCTYPE html>
<html>
<style>
  table {
    border-collapse: collapse;
    width: 100%;
    margin-bottom: 20px;
  }
  th, td {
    border: 1px solid #888;
    padding: 8px;
    text-align: left;
  }
  th {
    background-color: #f2f2f2;
  }
</style>

<head>
    <title>QuitBet - Transactions</title>
</head>
<body>
    <h2>🔍 Transactions for {{ email }}</h2>

    <h3>🧠 Gemini Insight</h3>
    <p>{{ insight }}</p>

    <h3>⚠️ Gambling Transactions</h3>
    <ul>
        <table>
        <tr><th>Date</th> <th>Service</th> <th>Amount bet</th> <th>Gain/Loss</th></tr>
        {% for txn in gambling %}
            <tr><td>{{ txn.date }}</td> <td>{{ txn.name }} </td> <td>- ${{ txn.amount }}</td> <td>{{txn.winnings}} </td> </tr>
        {% else %}
            <tr><td>✅ No gambling-related transactions found.<tr><td>
        {% endfor %}
        </table>

    </ul>

    <h3>📋 All Recent Transactions</h3>
    <ul>
        <table>
      <tr><th>Date</th> <th>Service</th> <th>Amount</th></tr>
          {% for txn in transactions %}
            <tr><td>{{ txn.date }}</td> <td>{{ txn.name }}</td> <td>${{ txn.amount }}</td></tr>
          {% endfor %}
    </table>
    </ul>



    <h3>📈 Your Progress</h3>
    <ul>
      <li>🔥 Days clean: {{ days_clean }}</li>
      <li>🧮 Daily Estimated Spend: ${{ daily_spend_estimate }}</li>

    </ul>

    {% if daily_checkin %}
      <h3>📬 Daily Check-in</h3>
      <p>{{ daily_checkin }}</p>
    {% endif %}


    {% if reflect_state == "ask" %}
      <h3>🧠 Gemini Check-in</h3>
      <p>Would you like to reflect on your progress today?</p>
      <a href="?reflect=yes"><button>Yes, let’s do it</button></a>
      <a href="?reflect=no"><button>No thanks</button></a>
    {% elif reflect_state == "yes" and personal_question %}
      <h3>🧠 Gemini’s Personalized Question for You</h3>
      <p>{{ personal_question }}</p>
      <form method="POST" action="/answer_question/{{ email }}">
        <label for="response">Your Reflection:</label><br>
        <textarea name="response" rows="4" cols="50" required></textarea><br>
        <button type="submit">Submit</button>
      </form>
    {% elif reflect_state == "no" %}
      <p>✅ No problem! Come back anytime you’d like to reflect.</p>
    {% endif %}



    <p>
      <a href="/login" style="padding: 8px 16px; background: #4285F4; color: white; text-decoration: none; border-radius: 8px;">
        🔙 Back to Main Page
      </a>
    </p>
</body>
</html>
